apiVersion: v1
kind: ConfigMap
metadata:
  name: gitea-environment
  namespace: gitea

data:

    # Regular environment variables that control Gitea's behavior,
    # and some that apply to the init containers.

    GITEA_APP_INI: /data/gitea/conf/app.ini
    GITEA_CUSTOM: /data/gitea
    GITEA_WORK_DIR: /data
    GITEA_TEMP: /tmp/gitea

    # The following are all environment variables that correspond to app.ini values

    GITEA____APP_NAME: "Kubernasty Gitea: The Nastiest Git Service In The 'Verse"

    # NOTE: gitea needs its own IP address from the load balancer in order to listen on port 22

    # [server]
    GITEA__server__APP_DATA_PATH: /data
    GITEA__server__DOMAIN: gitea.micahrl.me
    GITEA__server__ENABLE_PPROF: "false"
    GITEA__server__HTTP_PORT: "3000"
    # The protocol the server listens on
    GITEA__server__PROTOCOL: http
    # Overwrite the automatically generated public URL
    GITEA__server__ROOT_URL: https://gitea.micahrl.me
    GITEA__server__SSH_DOMAIN: gitea.micahrl.me
    # The port number the SSH server listens on in the container (required >1024 because we use rootless images)
    GITEA__server__SSH_LISTEN_PORT: "2222"
    # The port number exposed in the clone URL
    GITEA__server__SSH_PORT: "22"
    GITEA__server__START_SSH_SERVER: "true"

    # [database]
    GITEA__database__DB_TYPE: postgres
    GITEA__database__HOST: gitea-pg-cluster-rw
    GITEA__database__NAME: gitea

    # [security]
    GITEA__security__INSTALL_LOCK: "true"

    # [repository]
    GITEA__repository__ROOT: /data/git/gitea-repositories

    # [indexer]
    GITEA__indexer__ISSUE_INDEXER_TYPE: db

    # [queue]
    GITEA__queue__TYPE: level

    # [cache]
    GITEA__cache__ADAPTER: memory

    # [session]
    # db provider will reuse the configuration in [database]
    GITEA__session__PROVIDER: db

    # [metrics]
    GITEA__metrics__ENABLED: "false"
