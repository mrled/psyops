apiVersion: v1
kind: ConfigMap
metadata:
  name: keycloakdb-value-overrides
  namespace: keycloak
data:
  values.yaml: |-
    global:
      postgresql:
        auth:
          username: keycloak
          # Reads from the .password key on this secret
          existingSecret: keycloakdb-pass
          database: keycloak
      storageClass: knty-rep3
    primary:
      # initContainers:
      #   - name: perpermission
      #     image: busybox:1.28
      #     command: ['sh', '-c']
      #     args:
      #       - |+
      #         ls -alF /pgsql-data
      #         sleep infinity
      #     volumeMounts:
      #     - name: keycloakdb-data-vol
      #       mountPath: /pgsql-data
      #       readOnly: false
      extraVolumes:
        - name: keycloakdb-data-vol
          persistentVolumeClaim:
            claimName: keycloakdb-data-claim
      extraVolumeMounts:
        - name: keycloakdb-data-vol
          mountPath: /bitnami/postgresql/data
          readOnly: false
    volumePermissions:
      enabled: true
