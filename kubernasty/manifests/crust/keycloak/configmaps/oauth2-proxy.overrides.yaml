apiVersion: v1
kind: ConfigMap
metadata:
  name: oauth2-proxy-value-overrides
  namespace: keycloak
data:
  values.yaml: |-
    config:
      clientID:
        valueFrom:
          secretKeyRef:
            name: oauth2proxy-secrets
            key: oidc-client-id
      clientSecret:
        valueFrom:
          secretKeyRef:
            name: oauth2proxy-secrets
            key: oidc-client-secret
      cookieSecret:
        valueFrom:
          secretKeyRef:
            name: oauth2proxy-secrets
            key: auth-secret
      ingress:
        enabled: true
        path: /
        pathType: Prefix
        hosts: [oauth2-proxy.kubernasty.micahrl.com]
        annotations:
          cert-manager.io/cluster-issuer: letsencrypt-issuer-prod
          kubernetes.io/ingress.class: traefik
        tls:
          - hosts: [oauth2-proxy.kubernasty.micahrl.com]
            secretName: oauth2-proxy-cert-backing-secret
      configFile: |-
        reverse-proxy: true
