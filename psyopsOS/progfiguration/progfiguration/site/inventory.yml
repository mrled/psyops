---

# Progfiguration inventory

groupNodeMap:
  kubernasty:
    - jesseta
    - kenasus
    - zalas
    - psyopsos-test-1
  privnet:
    - agassiz

# WARNING: Any host not listed in the nodeFunctionMap is not visible and will not be in the 'universal' group.
nodeFunctionMap:
  jesseta: kubernasty
  kenasus: kubernasty
  zalas: kubernasty
  psyopsos-test-1: kubernasty
  newjutland: synergycontroller
  agassiz: privnet

functionRoleMap:
  kubernasty:
    - psynet
    - psyopsos_postboot_config
    - emailfwd
    - blockdevparty
    - datadisk_v2
    - k3s
  synergycontroller:
    - psynet
    - psyopsos_postboot_config
    - emailfwd
    # We need datadisk bc we need Flatpak for Synergy, and Flatpak is too disk hungry for RAM
    # Using the old version that doesn't have partitioning/encryption support
    - datadisk_v1
    - synergycontroller
  # TODO: fall back to this role so that we don't have to place new nodes in roleFunctionMap
  # and they will still come up.
  default:
    - psynet
    - psyopsos_postboot_config
  privnet:
    - psynet
    - psyopsos_postboot_config
    - emailfwd
    - blockdevparty
    - datadisk_v2
    - syslog_collector
    - capthook
    - acmeupdater_base
    - acmeupdater_synology
    - pullbackup
    - pullbackup_email
    - pullbackup_unifi

nodeSettings:
  # The location for the age key on each node
  # If multiple items are specified here, they are checked in order and the first found is used
  age:
    - /mnt/psyops-secret/mount/age.key

controller:
  # The controller has an age key which can be used to decrypt any secret.
  # When this file is not present, progfiguration will still work,
  # but activities that require the secret key will throw errors.
  age: /secrets/psyops-secrets/progfiguration/controller.age

  # We must hard code the public key in this file as well,
  # so that it is available even when we aren't running on the controller.
  agepub: age18mfpm3htk5dvtygtcajqkcmr8775dy35uykgx5tmfanpmwznyc2qs3smh2
