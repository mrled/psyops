apiVersion: v1
kind: ConfigMap
metadata:
  name: seedboxk8s-config
  namespace: flux-system

data:

  # I am not impressed with the way Flux and/or Kustomize handles ConfigMaps.
  # Here are some examples for our edification.
  #
  # This is a string, like normal YAML. Great.
  # exampleStr: asdf
  # This is INVALID. Kustomize requires all values in this file to be strings.
  # exampleIntINVALID: 123
  # Instead, you must make it a string:
  # exampleIntValid: "123"
  #
  # Flux has its own Kustomization type kustomization.kustomize.toolkit.fluxcd.io.
  # <https://fluxcd.io/flux/faq/#are-there-two-kustomization-types>
  # It can do neat things like substitute values from ConfigMaps with postBuild.substituteFrom.
  # However, when it does that, it effectively unquotes any value.
  # For things that are still strings if the quotes are removed, like exampleStr above, this is fine.
  # But for things that are another type if the quotes are removed, like exampleIntValid above,
  # this can be a problem.
  # Because what if you need to force a value to be a string?
  #
  # There's another piece of this puzzle, which is that Kubernetes will validate manifests by type.
  # It is very bad at this job, because most things are strings,
  # and because it uses YAML which is very bad at this job.
  # But it still tries.
  # And one thing it knows is that environment variables are always strings.
  # So if you are trying to pass a number to a container as an environment variable,
  # you have to DOUBLE QUOTE IT HERE IN THE CONFIG MAP.
  # <https://github.com/kubernetes-sigs/kustomize/issues/5558>
  # ...
  # <a horrible scream>
  # ...
  # That looks like this:
  # exampleStringContainingNumbers: '"123"'

  quote: '"'

  clusterTld: younix.us
  clusterPrimaryDns: seedbox.younix.us
  clusterPrimaryIp: "100.86.119.112"
  nodeLocalSlowStorageRoot: /seedboxmedia/seedboxk8s

  dexClientId: SeedboxK8sDexClientAuth-younix.us

  timezone: America/Chicago

  # Let's keep track of two versions of the same thing, I love doing that, that's what I like about using computers. Fuck's sake.
  plexUid: "989"
  plexGid: "986"
  plexUidStr: '"989"'
  plexGidStr: '"986"'

  # This is exposed as a NodePort and therefore must be in the node port range for the cluster;
  # by default this is 30000-32767.
  # These ports must be forwarded from the router.
  # TODO: consider traefik IngressRouteTCP and IngressRouteUDP instead of a NodePort.
  transmissionPeerPort: "30298"
